# VideoChatLLM - å¤šæ¨¡æ…‹ ChatLLM å‰µä½œç³»çµ±

ä¸€å€‹åŸºæ–¼ Gemini API çš„æ™ºèƒ½å¤šæ¨¡æ…‹ ChatLLM å‰µä½œåŠ©æ‰‹ï¼Œæ•´åˆåœ–æ–‡ç”Ÿæˆã€è¦–é »è£½ä½œã€èªéŸ³è½‰æ›ç­‰å¤šç¨®å‰µä½œå·¥å…·ã€‚

**ç¾åœ¨æ”¯æ´ Spec-Kit æ¶æ§‹ï¼** è¦‹ [Spec-Kit æ–‡æª”](./README_SPECKIT.md)

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **æ™ºèƒ½å°è©±æ ¸å¿ƒ**: ä½¿ç”¨ Gemini API æä¾›å¼·å¤§çš„è‡ªç„¶èªè¨€ç†è§£å’Œä¸Šä¸‹æ–‡ç®¡ç†
- **å¤šæ¨¡æ…‹å‰µä½œ**: æ•´åˆæ–‡ç”Ÿåœ–ã€åœ–ç”Ÿåœ–ã€åœ–ç”Ÿè¦–é »ã€èªéŸ³ç”Ÿè¦–é »ç­‰å®Œæ•´å‰µä½œæµç¨‹
- **æ±ºç­–æ™ºèƒ½é«”**: è‡ªå‹•åˆ†æç”¨æˆ¶éœ€æ±‚ï¼Œæ™ºèƒ½èª¿åº¦å„æ¨¡æ…‹å·¥å…·
- **å·¥ä½œæµç®¡ç†**: åŸºæ–¼ LangGraph å¯¦ç¾ä»»å‹™ç·¨æ’å’Œä¾è³´ç®¡ç†
- **è¨˜æ†¶ç³»çµ±**: æŒä¹…åŒ–å°è©±æ­·å²ã€ä»»å‹™ç‹€æ…‹å’Œç”¨æˆ¶åå¥½
- **éŒ¯èª¤è™•ç†**: å®Œå–„çš„ç•°å¸¸è™•ç†ã€é‡è©¦æ©Ÿåˆ¶å’Œä»»å‹™å›æº¯åŠŸèƒ½

## ğŸ—ï¸ æ¶æ§‹è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   VideoChatLLM                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Gemini å°è©±å¼•æ“ â†’ æ±ºç­–æ™ºèƒ½é«” â†’ åŸ·è¡Œè¨ˆåŠƒ                â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ–‡ç”Ÿåœ–/åœ–ç”Ÿåœ– â”‚  â”‚  åœ–ç”Ÿè¦–é »     â”‚  â”‚ èªéŸ³ç”Ÿè¦–é »  â”‚  â”‚
â”‚  â”‚ NanoBanana   â”‚  â”‚   Veo3.1     â”‚  â”‚ Wan2/Kling â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚
â”‚  â”œâ”€ LangGraph å·¥ä½œæµ                                â”‚
â”‚  â”œâ”€ è¨˜æ†¶ç®¡ç†ç³»çµ±                                     â”‚
â”‚  â””â”€ éŒ¯èª¤è™•ç†èˆ‡å›æº¯                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ å®‰è£èˆ‡é…ç½®

### 1. å®‰è£ä¾è³´

```bash
pip install -r requirements.txt
```

### 2. é…ç½®ç’°å¢ƒè®Šæ•¸

è¤‡è£½ `.env.example` ä¸¦å‘½åç‚º `.env`ï¼Œå¡«å…¥ç›¸æ‡‰çš„ API å¯†é‘°ï¼š

```bash
cp .env.example .env
```

ç·¨è¼¯ `.env` æ–‡ä»¶ï¼š

```env
# Gemini API
GEMINI_API_KEY=your_gemini_api_key_here

# NanoBanana API
NANOBANANA_API_KEY=your_nanobanana_api_key_here

# Veo3.1 API
VEO_API_KEY=your_veo_api_key_here

# Wan2.2 / Kling AI
WAN2_API_KEY=your_wan2_api_key_here
KLING_API_KEY=your_kling_api_key_here
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### åŸºæœ¬ä½¿ç”¨

```python
from main import VideoChatLLM
import asyncio

async def main():
    # åˆå§‹åŒ– ChatLLM
    chatllm = VideoChatLLM()
    
    # è™•ç†ç”¨æˆ¶è«‹æ±‚
    result = await chatllm.process_request(
        user_input="å¹«æˆ‘ç”Ÿæˆä¸€å¼µå¤•é™½ä¸‹çš„æµ·ç˜é¢¨æ™¯åœ–",
        session_id="my_session",
        user_id="user_123"
    )
    
    print(result["response"])
    print(result["results"])

asyncio.run(main())
```

### é‹è¡Œä¸»ç¨‹åº

```bash
python main.py
```

## ğŸ“š åŠŸèƒ½æ¨¡çµ„

### 1. Gemini å°è©±å¼•æ“ (`core/gemini_engine.py`)

æä¾›è‡ªç„¶èªè¨€å°è©±åŠŸèƒ½ï¼š
- å¤šè¼ªå°è©±æ”¯æŒ
- ä»»å‹™é¡å‹æª¢æ¸¬
- ä¸Šä¸‹æ–‡ç®¡ç†

### 2. æ±ºç­–æ™ºèƒ½é«” (`core/decision_agent.py`)

æ™ºèƒ½ä»»å‹™èª¿åº¦ï¼š
- è‡ªå‹•è­˜åˆ¥å‰µä½œéœ€æ±‚
- ç”ŸæˆåŸ·è¡Œè¨ˆåŠƒ
- ç®¡ç†ä»»å‹™ä¾è³´

### 3. è¨˜æ†¶ç®¡ç†ç³»çµ± (`core/memory_manager.py`)

æŒä¹…åŒ–ç‹€æ…‹ç®¡ç†ï¼š
- å°è©±æ­·å²è¨˜éŒ„
- ä»»å‹™ç‹€æ…‹è·Ÿè¹¤
- ç”¨æˆ¶åå¥½è¨­ç½®

### 4. åœ–åƒç”Ÿæˆå·¥å…· (`tools/image_generator.py`)

NanoBanana æ–‡ç”Ÿåœ–/åœ–ç”Ÿåœ–ï¼š
- æ–‡ç”Ÿåœ–
- åœ–ç”Ÿåœ–ï¼ˆé¢¨æ ¼è½‰æ›ï¼‰

### 5. è¦–é »ç”Ÿæˆå·¥å…· (`tools/video_generator.py`)

Veo3.1 åœ–ç”Ÿè¦–é »ï¼š
- éœæ…‹åœ–ç‰‡è½‰å‹•æ…‹è¦–é »
- ç•°æ­¥ä»»å‹™è™•ç†

### 6. èªéŸ³ç”Ÿè¦–é »å·¥å…· (`tools/speech2video.py`)

Wan2.2 / Kling AIï¼š
- èªéŸ³è½‰è¦–é »
- æ–‡æœ¬+èªéŸ³æ··åˆç”Ÿæˆ

### 7. å·¥ä½œæµåŸ·è¡Œå™¨ (`workflow/langgraph_executor.py`)

LangGraph ä»»å‹™ç·¨æ’ï¼š
- ä»»å‹™é †åºåŸ·è¡Œ
- ä¾è³´é—œä¿‚ç®¡ç†
- æ¢ä»¶åˆ†æ”¯æ§åˆ¶

### 8. éŒ¯èª¤è™•ç†å™¨ (`core/error_handler.py`)

ç•°å¸¸ç®¡ç†æ©Ÿåˆ¶ï¼š
- éŒ¯èª¤åˆ†é¡èˆ‡é‡è©¦
- ä»»å‹™å›æº¯
- çµ±è¨ˆåˆ†æ

## ğŸ”§ é€²éšç”¨æ³•

### è‡ªå®šç¾©åŸ·è¡Œè¨ˆåŠƒ

```python
from core import DecisionAgent, TaskType

agent = DecisionAgent()
plan = agent.analyze_request(gemini_response, user_context)
```

### ç®¡ç†ç”¨æˆ¶åå¥½

```python
from core import MemoryManager

memory = MemoryManager()
memory.update_user_preferences("user_123", {
    "image_size": "2048x2048",
    "image_style": "anime",
    "video_duration": 10
})
```

### éŒ¯èª¤è™•ç†èˆ‡é‡è©¦

```python
from core.error_handler import ErrorHandler, ErrorType

handler = ErrorHandler(max_retries=5)
error_info = handler.handle_error(exception, context)
strategy = handler.get_retry_strategy(ErrorType.API_ERROR)
```

## ğŸ“Š ä½¿ç”¨å ´æ™¯

### å ´æ™¯ 1: æ–‡ç”Ÿåœ–

```
ç”¨æˆ¶: "å¹«æˆ‘ç”Ÿæˆä¸€å¼µå¤•é™½ä¸‹çš„æµ·ç˜é¢¨æ™¯åœ–"
ç³»çµ±: [èª¿ç”¨ NanoBanana] â†’ ç”Ÿæˆåœ–ç‰‡
```

### å ´æ™¯ 2: åœ–ç”Ÿè¦–é »

```
ç”¨æˆ¶: "æŠŠå‰›æ‰çš„åœ–ç‰‡åšæˆå‹•æ…‹è¦–é »"
ç³»çµ±: [èª¿ç”¨ Veo3.1] â†’ ç”Ÿæˆè¦–é »
```

### å ´æ™¯ 3: å®Œæ•´å‰µä½œæµç¨‹

```
ç”¨æˆ¶: "æˆ‘æƒ³å‰µå»ºä¸€å€‹å®Œæ•´ä½œå“ï¼šä¸€éš»å¯æ„›çš„å°è²“åœ¨èŠ±åœ’è£¡"
ç³»çµ±: [æ–‡ç”Ÿåœ–] â†’ [åœ–ç”Ÿè¦–é »] â†’ [çµ„åˆè¼¸å‡º]
```

### å ´æ™¯ 4: èªéŸ³ç”Ÿè¦–é »

```
ç”¨æˆ¶: [ä¸Šå‚³éŸ³é »]
ç³»çµ±: [èª¿ç”¨ Kling AI] â†’ [ç”Ÿæˆè¦–é »]
```

## ğŸ› ï¸ é–‹ç™¼èˆ‡æ“´å±•

### æ·»åŠ æ–°çš„æ¨¡æ…‹å·¥å…·

1. åœ¨ `tools/` ç›®éŒ„å‰µå»ºæ–°çš„å·¥å…·é¡
2. å¯¦ç¾çµ±ä¸€çš„æ¥å£è¦ç¯„
3. åœ¨ `DecisionAgent` ä¸­æ·»åŠ èª¿åº¦é‚è¼¯
4. æ›´æ–° `main.py` ä¸­çš„åŸ·è¡Œé‚è¼¯

### è‡ªå®šç¾©å·¥ä½œæµ

ä¿®æ”¹ `workflow/langgraph_executor.py` ä¸­çš„åœ–çµæ§‹å’Œç¯€é»é‚è¼¯ã€‚

## ğŸ“ é…ç½®é¸é …

åœ¨ `config.py` æˆ– `.env` ä¸­å¯ä»¥é…ç½®ï¼š

- `MAX_RETRY_ATTEMPTS`: æœ€å¤§é‡è©¦æ¬¡æ•¸
- `TIMEOUT_SECONDS`: API èª¿ç”¨è¶…æ™‚æ™‚é–“
- `ENABLE_MEMORY`: æ˜¯å¦å•Ÿç”¨è¨˜æ†¶åŠŸèƒ½
- `DEFAULT_TEMPERATURE`: Gemini API æº«åº¦åƒæ•¸

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è¨±å¯

MIT License

## ğŸ™ è‡´è¬

- Google Gemini API
- NanoBanana
- Veo3.1
- Wan2.2 / Kling AI
- LangGraph

